# References:
# - https://admin-serv.net/blog/670/creer-et-installer-un-certificat-ssl-sous-nginx/

server {
  listen 80;
  listen [::]:80 ipv6only=on;
  return 301 https://$host$request_uri;
}

server {
  listen 443;
  listen [::]:443 ipv6only=on;

  server_name 192.168.50.4;

  ssl on;
  ssl_certificate      /etc/nginx/cert.crt;
  ssl_certificate_key  /etc/nginx/cert.key;

  access_log           /var/log/nginx/jenkins.access.log;

  location / {
    root /usr/share/nginx/html;
    index index.html index.htm;

    try_files $uri $uri/ =404;

    auth_basic "Restricted Content";
    auth_basic_user_file /etc/nginx/.htpasswd;
  }
}
